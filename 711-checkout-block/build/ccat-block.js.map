{"version":3,"file":"ccat-block.js","mappings":"uCASa,IAAIA,EAAE,EAAQ,KAASC,EAAEC,OAAOC,IAAI,iBAAiBC,EAAEF,OAAOC,IAAI,kBAAkBE,EAAEC,OAAOC,UAAUC,eAAeC,EAAET,EAAEU,mDAAmDC,kBAAkBC,EAAE,CAACC,KAAI,EAAGC,KAAI,EAAGC,QAAO,EAAGC,UAAS,GAChP,SAASC,EAAEC,EAAEC,EAAEC,GAAG,IAAIC,EAAEC,EAAE,CAAC,EAAEC,EAAE,KAAKC,EAAE,KAAiF,IAAIH,UAAhF,IAASD,IAAIG,EAAE,GAAGH,QAAG,IAASD,EAAEN,MAAMU,EAAE,GAAGJ,EAAEN,UAAK,IAASM,EAAEL,MAAMU,EAAEL,EAAEL,KAAcK,EAAEd,EAAEoB,KAAKN,EAAEE,KAAKT,EAAEJ,eAAea,KAAKC,EAAED,GAAGF,EAAEE,IAAI,GAAGH,GAAGA,EAAEQ,aAAa,IAAIL,KAAKF,EAAED,EAAEQ,kBAAe,IAASJ,EAAED,KAAKC,EAAED,GAAGF,EAAEE,IAAI,MAAM,CAACM,SAAS1B,EAAE2B,KAAKV,EAAEL,IAAIU,EAAET,IAAIU,EAAEK,MAAMP,EAAEQ,OAAOrB,EAAEsB,QAAQ,CAACC,EAAQC,SAAS7B,EAAE4B,EAAQE,IAAIjB,EAAEe,EAAQG,KAAKlB,C,UCV1WmB,EAAOJ,QAAUK,OAAc,K,gBCG7BD,EAAOJ,QAAU,EAAjB,G,GCFEM,EAA2B,CAAC,ECDhC,MAAM,EAA+BD,OAAW,GAAW,QCArD,EAA+BA,OAAW,GAAQ,KCAlD,EAA+BA,OAAW,GAAQ,K,MHIxD,SAASE,EAAoBC,GAE5B,IAAIC,EAAeH,EAAyBE,GAC5C,QAAqBE,IAAjBD,EACH,OAAOA,EAAaT,QAGrB,IAAII,EAASE,EAAyBE,GAAY,CAGjDR,QAAS,CAAC,GAOX,OAHAW,EAAoBH,GAAUJ,EAAQA,EAAOJ,QAASO,GAG/CH,EAAOJ,OACf,C,MIlBO,M,8DCEPY,ECNqCP,OAAW,GAAU,ODM1DO,mBAAkBC,EAAAA,KAAe,CAC7BC,KDHiBC,EAAEC,wBAAuBC,iBAC1C,MAAOC,EAAWC,IAAgBC,EAAAA,EAAAA,WAAS,IACpCC,EAAWC,IAAgBF,EAAAA,EAAAA,UAAS,CACvCG,UAAW,GACXC,QAAS,GACTC,aAAc,KAGZC,GAAgBC,EAAAA,EAAAA,YAAWC,GACfA,EAAO,iBACRC,cAAcH,iBAIzB,sBAACI,IAAyBC,EAAAA,EAAAA,aAAY,qBA4D5C,OAjBAC,EAAAA,EAAAA,YAAU,KAEN,GADAb,GAAa,GACTO,EAAcO,OAAQ,CACtB,MAAMC,EA5CkBR,KAC5B,IAAKA,EAAcO,OACf,MAAO,GAGX,IAAIC,EAAc,GAClB,IAAK,IAAIC,EAAI,EAAGA,EAAIT,EAAcO,OAAQE,IACtC,GAAKT,EAAcS,GAAGC,eAGtB,IAAK,IAAIC,EAAI,EAAGA,EAAIX,EAAcS,GAAGC,eAAeH,OAAQI,IACxDH,EAAYI,KAAKZ,EAAcS,GAAGC,eAAeC,IAIzD,OAAOH,CAAW,EA6BMK,CAAuBb,GAC3C,IAAK,IAAIS,EAAI,EAAGA,EAAID,EAAYD,OAAQE,IAC/BD,EAAYC,GAAGK,SAGhBN,EAAYC,GAAGK,QAAQC,SAAS,yBAA2BP,EAAYC,GAAGO,UAC1EvB,GAAa,EAGzB,IACD,CACCO,IAGCR,GAKDyB,EAAAA,EAAAA,MAAA,OAAKC,UAAU,4CAA2CC,SAAA,EACtDC,EAAAA,EAAAA,KAAA,MAAAD,UAAKE,EAAAA,EAAAA,IAAG,eAAgB,uBACxBJ,EAAAA,EAAAA,MAAA,OAAKC,UAAU,qDAAoDC,SAAA,EAC/DC,EAAAA,EAAAA,KAAA,UAAQlD,KAAK,SACLgD,UAAU,6BACVI,QAjDOC,IAGvB,MAAMC,EAAoB,CACtB3B,UAAW,YACXC,QAAS,UACTC,aAAc,iBAGlBH,EAAa4B,GAGbpB,EAAsB,CAClBqB,UAAW,GAAGD,EAAkB3B,cAAc2B,EAAkB1B,WAChE4B,UAAWF,EAAkBzB,aAC7B4B,KAAM,MACNC,MAAO,MACPC,SAAU,QACVC,QAAS,MACX,EA8ByCX,UAE9BE,EAAAA,EAAAA,IAAG,OAAQ,sBAGf1B,EAAUE,YACPoB,EAAAA,EAAAA,MAAA,OAAKC,UAAU,wCAAuCC,SAAA,EAClDF,EAAAA,EAAAA,MAAA,KAAAE,SAAA,EAAGC,EAAAA,EAAAA,KAAA,UAAAD,UAASE,EAAAA,EAAAA,IAAG,SAAU,sBAA6B,IAAE1B,EAAUE,cAClEoB,EAAAA,EAAAA,MAAA,KAAAE,SAAA,EAAGC,EAAAA,EAAAA,KAAA,UAAAD,UAASE,EAAAA,EAAAA,IAAG,QAAS,sBAA6B,IAAE1B,EAAUG,YACjEmB,EAAAA,EAAAA,MAAA,KAAAE,SAAA,EAAGC,EAAAA,EAAAA,KAAA,UAAAD,UAASE,EAAAA,EAAAA,IAAG,QAAS,sBAA6B,IAAE1B,EAAUI,0BAlB1EqB,EAAAA,EAAAA,KAAAW,EAAAA,SAAA,GAsBD,EC7FVC,KAAMA,IAAM,M","sources":["webpack://ccat-checkout-block/./node_modules/react/cjs/react-jsx-runtime.production.min.js","webpack://ccat-checkout-block/external window \"React\"","webpack://ccat-checkout-block/./node_modules/react/jsx-runtime.js","webpack://ccat-checkout-block/webpack/bootstrap","webpack://ccat-checkout-block/external window [\"wp\",\"element\"]","webpack://ccat-checkout-block/external window [\"wp\",\"i18n\"]","webpack://ccat-checkout-block/external window [\"wp\",\"data\"]","webpack://ccat-checkout-block/./src/js/ccat-block/block.js","webpack://ccat-checkout-block/./src/js/ccat-block/index.js","webpack://ccat-checkout-block/external window [\"wp\",\"blocks\"]"],"sourcesContent":["/**\n * @license React\n * react-jsx-runtime.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';var f=require(\"react\"),k=Symbol.for(\"react.element\"),l=Symbol.for(\"react.fragment\"),m=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p={key:!0,ref:!0,__self:!0,__source:!0};\nfunction q(c,a,g){var b,d={},e=null,h=null;void 0!==g&&(e=\"\"+g);void 0!==a.key&&(e=\"\"+a.key);void 0!==a.ref&&(h=a.ref);for(b in a)m.call(a,b)&&!p.hasOwnProperty(b)&&(d[b]=a[b]);if(c&&c.defaultProps)for(b in a=c.defaultProps,a)void 0===d[b]&&(d[b]=a[b]);return{$$typeof:k,type:c,key:e,ref:h,props:d,_owner:n.current}}exports.Fragment=l;exports.jsx=q;exports.jsxs=q;\n","module.exports = window[\"React\"];","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/react-jsx-runtime.production.min.js');\n} else {\n  module.exports = require('./cjs/react-jsx-runtime.development.js');\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","const __WEBPACK_NAMESPACE_OBJECT__ = window[\"wp\"][\"element\"];","const __WEBPACK_NAMESPACE_OBJECT__ = window[\"wp\"][\"i18n\"];","const __WEBPACK_NAMESPACE_OBJECT__ = window[\"wp\"][\"data\"];","import {useState, useEffect} from '@wordpress/element';\r\nimport {__} from '@wordpress/i18n';\r\nimport {useSelect, useDispatch} from '@wordpress/data';\r\n\r\nexport const Block = ({checkoutExtensionData, extensions}) => {\r\n    const [showBlock, setShowBlock] = useState(false);\r\n    const [storeInfo, setStoreInfo] = useState({\r\n        storeName: '',\r\n        storeId: '',\r\n        storeAddress: ''\r\n    });\r\n\r\n    const shippingRates = useSelect((select) => {\r\n        const store = select('wc/store/cart');\r\n        return store.getCartData().shippingRates;\r\n    });\r\n\r\n    // 獲取 dispatch 方法來修改地址\r\n    const {updateShippingAddress} = useDispatch('wc/store/checkout');\r\n\r\n    const getActiveShippingRates = (shippingRates) => {\r\n        if (!shippingRates.length) {\r\n            return [];\r\n        }\r\n\r\n        let activeRates = [];\r\n        for (let i = 0; i < shippingRates.length; i++) {\r\n            if (!shippingRates[i].shipping_rates) {\r\n                continue;\r\n            }\r\n            for (let j = 0; j < shippingRates[i].shipping_rates.length; j++) {\r\n                activeRates.push(shippingRates[i].shipping_rates[j]);\r\n            }\r\n        }\r\n\r\n        return activeRates;\r\n    };\r\n\r\n    // 處理超商選擇\r\n    const handleStoreSelect = (event) => {\r\n        // 假設這裡會從某個 API 獲取超商資訊\r\n        // 這只是模擬資料\r\n        const selectedStoreInfo = {\r\n            storeName: '7-11 測試門市',\r\n            storeId: 'TW12345',\r\n            storeAddress: '台北市信義區松高路123號'\r\n        };\r\n\r\n        setStoreInfo(selectedStoreInfo);\r\n\r\n        // 更新送件地址\r\n        updateShippingAddress({\r\n            address_1: `${selectedStoreInfo.storeName} (${selectedStoreInfo.storeId})`,\r\n            address_2: selectedStoreInfo.storeAddress,\r\n            city: '台北市',\r\n            state: '台北市',\r\n            postcode: '11050',\r\n            country: 'TW'\r\n        });\r\n    };\r\n\r\n    useEffect(() => {\r\n        setShowBlock(false);\r\n        if (shippingRates.length) {\r\n            const activeRates = getActiveShippingRates(shippingRates);\r\n            for (let i = 0; i < activeRates.length; i++) {\r\n                if (!activeRates[i].rate_id) {\r\n                    continue;\r\n                }\r\n                if (activeRates[i].rate_id.includes(\"wc_shipping_ccat_711\") && activeRates[i].selected) {\r\n                    setShowBlock(true);\r\n                }\r\n            }\r\n        }\r\n    }, [\r\n        shippingRates\r\n    ]);\r\n\r\n    if (!showBlock) {\r\n        return <></>\r\n    }\r\n\r\n    return (\r\n        <div className=\"wc-block-components-shipping-cvs-selector\">\r\n            <h4>{__('選擇 7-11 取貨門市', 'your-text-domain')}</h4>\r\n            <div className=\"wc-block-components-shipping-cvs-selector__content\">\r\n                <button type=\"button\"\r\n                        className=\"wc-block-components-button\"\r\n                        onClick={handleStoreSelect}\r\n                >\r\n                    {__('選擇門市', 'your-text-domain')}\r\n                </button>\r\n\r\n                {storeInfo.storeName && (\r\n                    <div className=\"wc-block-components-shipping-cvs-info\">\r\n                        <p><strong>{__('已選擇門市：', 'your-text-domain')}</strong> {storeInfo.storeName}</p>\r\n                        <p><strong>{__('門市代號：', 'your-text-domain')}</strong> {storeInfo.storeId}</p>\r\n                        <p><strong>{__('門市地址：', 'your-text-domain')}</strong> {storeInfo.storeAddress}</p>\r\n                    </div>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n};","// src/js/ccat-block/index.js\r\nimport {Block} from './block'\r\nimport metadata from './block.json'\r\nimport {registerBlockType} from '@wordpress/blocks';\r\n\r\n// 在區塊編輯器中註冊區塊\r\nregisterBlockType(metadata.name, {\r\n    edit: Block,\r\n    save: () => null,\r\n});","const __WEBPACK_NAMESPACE_OBJECT__ = window[\"wp\"][\"blocks\"];"],"names":["f","k","Symbol","for","l","m","Object","prototype","hasOwnProperty","n","__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED","ReactCurrentOwner","p","key","ref","__self","__source","q","c","a","g","b","d","e","h","call","defaultProps","$$typeof","type","props","_owner","current","exports","Fragment","jsx","jsxs","module","window","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","registerBlockType","metadata","edit","Block","checkoutExtensionData","extensions","showBlock","setShowBlock","useState","storeInfo","setStoreInfo","storeName","storeId","storeAddress","shippingRates","useSelect","select","getCartData","updateShippingAddress","useDispatch","useEffect","length","activeRates","i","shipping_rates","j","push","getActiveShippingRates","rate_id","includes","selected","_jsxs","className","children","_jsx","__","onClick","event","selectedStoreInfo","address_1","address_2","city","state","postcode","country","_Fragment","save"],"sourceRoot":""}