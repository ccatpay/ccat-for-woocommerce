(()=>{"use strict";var e={20:(e,o,t)=>{var s=t(609),r=Symbol.for("react.element"),c=(Symbol.for("react.fragment"),Object.prototype.hasOwnProperty),n=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function l(e,o,t){var s,l={},i=null,d=null;for(s in void 0!==t&&(i=""+t),void 0!==o.key&&(i=""+o.key),void 0!==o.ref&&(d=o.ref),o)c.call(o,s)&&!a.hasOwnProperty(s)&&(l[s]=o[s]);if(e&&e.defaultProps)for(s in o=e.defaultProps)void 0===l[s]&&(l[s]=o[s]);return{$$typeof:r,type:e,key:i,ref:d,props:l,_owner:n.current}}o.jsx=l,o.jsxs=l},609:e=>{e.exports=window.React},848:(e,o,t)=>{e.exports=t(20)}},o={};const t=window.wc.blocksCheckout,s=window.wp.element;window.wp.i18n;var r=function t(s){var r=o[s];if(void 0!==r)return r.exports;var c=o[s]={exports:{}};return e[s](c,c.exports,t),c.exports}(848);window.handleStoreSelection=e=>{window.opener&&window.opener.postMessage({storeInfo:e},"*")};const c=JSON.parse('{"apiVersion":2,"title":"ccat-for-woocommerce/ccat-for-woocommerce","name":"ccat-for-woocommerce/ccat-for-woocommerce","version":"1.0.0","category":"woocommerce","supports":{"html":false,"align":false,"multiple":false,"reusable":false},"parent":["woocommerce/checkout-shipping-methods-block"],"attributes":{"lock":{"type":"object","default":{"remove":true,"move":true}}},"textdomain":"ccat-for-woocommerce"}');(0,t.registerCheckoutBlock)({metadata:c,component:({checkoutExtensionData:e})=>{console.log("超商選擇器區塊組件渲染",e);const o=window.wc?.wcSettings?.getSetting("ccat--store-selector",{shippingMethods:{},labels:{selectStore:"選擇7-11超商門市",selectedStore:"已選擇門市",changeStore:"變更超商門市",storeAddress:"地址"}});o.shippingMethods&&0!==Object.keys(o.shippingMethods).length||(o.shippingMethods={wc_shipping_ccat__cod:{url:"https://emap.pcsc.com.tw/EMapSDK.aspx"},wc_shipping_ccat__prepaid:{url:"https://emap.pcsc.com.tw/EMapSDK.aspx"}});const[t,c]=(0,s.useState)((()=>{try{const e=localStorage.getItem("ccat_selected_store");return e?JSON.parse(e):null}catch(e){return console.error("讀取儲存的超商資訊時出錯:",e),null}}));return(0,r.jsx)("div",{className:"wc-block-components-panel",children:(0,r.jsx)("div",{className:"wc-block-components-panel__content",children:(0,r.jsxs)("div",{className:"ccat--store-selector-container",children:[(0,r.jsx)("h3",{className:"wc-block-components-title",children:"7-11 超商取貨"}),(0,r.jsx)("button",{className:"wc-block-components-button wp-element-button",onClick:()=>{const t=Object.values(o.shippingMethods)[0];if(!t||!t.url)return void console.error("找不到運送方式的配置");const s=window.open(t.url,"storeSelection","width=800,height=600"),r=o=>{try{o.data&&o.data.storeInfo&&((o=>{c(o);try{localStorage.setItem("ccat_selected_store",JSON.stringify(o))}catch(e){console.error("儲存超商資訊到localStorage時出錯:",e)}e&&e.setExtensionData&&e.setExtensionData("ccat--store-selector",{storeCode:o.storeCode,storeName:o.storeName,storeAddress:o.storeAddress})})(o.data.storeInfo),s&&s.close(),window.removeEventListener("message",r))}catch(e){console.error("處理超商選擇訊息時出錯:",e)}};window.addEventListener("message",r)},style:{width:"100%",marginBottom:"10px"},children:t?o.labels.changeStore:o.labels.selectStore}),t&&(0,r.jsxs)("div",{className:"ccat-selected-store-info",style:{padding:"10px",backgroundColor:"#f8f8f8",border:"1px solid #ddd",borderRadius:"4px"},children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("strong",{children:[o.labels.selectedStore,":"]}),t.storeName," (",t.storeCode,")"]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("strong",{children:[o.labels.storeAddress,":"]}),t.storeAddress]})]})]})})})}})})();
//# sourceMappingURL=ccat-block-frontend.js.map